<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Translator - All Languages</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- AdMob SDK -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-YOUR_ADMOB_PUBLISHER_ID"
            crossorigin="anonymous"></script>
    <!-- PDF Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        :root {
            --primary: #3b82f6;
            --primary-dark: #2563eb;
            --light: #ffffff;
            --dark: #1f2937;
            --gray: #6b7280;
            --light-gray: #f3f4f6;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--light);
            color: var(--dark);
            line-height: 1.6;
            padding-bottom: 100px; /* Space for ads */
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        header {
            padding: 15px 0;
            position: sticky;
            top: 0;
            background-color: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            z-index: 100;
            box-shadow: var(--shadow);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary);
            text-decoration: none;
        }

        .main {
            padding: 40px 0;
        }

        .translator-container {
            background-color: var(--light);
            border-radius: 12px;
            padding: 30px;
            box-shadow: var(--shadow);
            max-width: 800px;
            margin: 0 auto;
        }

        .language-selectors {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        select {
            flex: 1;
            padding: 12px 15px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            font-size: 16px;
            background-color: var(--light);
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 16px;
        }

        .swap-btn {
            background-color: var(--light-gray);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: none;
            transition: all 0.3s ease;
        }

        .swap-btn:hover {
            background-color: var(--primary);
            color: white;
        }

        textarea {
            width: 100%;
            min-height: 150px;
            padding: 15px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            font-size: 16px;
            resize: vertical;
            margin-bottom: 20px;
        }

        .translate-btn {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 16px;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .translate-btn:hover {
            background-color: var(--primary-dark);
        }

        .translate-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }

        .translation-result {
            background-color: var(--light-gray);
            border-radius: 8px;
            padding: 20px;
            min-height: 150px;
            margin-top: 20px;
        }

        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            color: var(--gray);
        }

        .error {
            color: #ef4444;
        }

        .floating-actions {
            position: fixed;
            bottom: 100px; /* Adjusted for ads */
            right: 30px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 90;
        }

        .floating-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
        }

        .floating-btn:hover {
            transform: translateY(-3px);
            background: var(--primary-dark);
        }

        /* PDF Upload/Download Styles */
        .file-upload-section {
            margin-bottom: 20px;
        }

        .file-upload-wrapper {
            display: flex;
            gap: 15px;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }

        .file-upload-label {
            background-color: var(--primary);
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 150px;
            justify-content: center;
        }

        .file-upload-label:hover {
            background-color: var(--primary-dark);
        }

        .download-btn {
            background-color: var(--gray);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 150px;
            justify-content: center;
        }

        .download-btn:hover {
            background-color: #4b5563;
        }

        .download-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .file-info {
            font-size: 14px;
            color: var(--gray);
            padding: 5px 0;
        }

        /* Ad Containers */
        .ad-container {
            width: 100%;
            position: fixed;
            bottom: 0;
            left: 0;
            background: white;
            padding: 10px;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            z-index: 99;
            display: flex;
            justify-content: center;
        }

        .ad-banner {
            width: 320px;
            height: 50px;
            background-color: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            color: #666;
            font-size: 14px;
        }

        @media (max-width: 768px) {
            .language-selectors {
                flex-direction: column;
            }
            
            .swap-btn {
                transform: rotate(90deg);
                margin: 10px 0;
            }
            
            .floating-actions {
                bottom: 90px;
                right: 20px;
            }

            .ad-banner {
                width: 100%;
                max-width: 320px;
            }
        }

        @media (max-width: 500px) {
            .file-upload-wrapper {
                flex-direction: column;
            }
            
            .file-upload-label,
            .download-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container header-content">
            <a href="#" class="logo">
                <span>Global Translator</span>
            </a>
        </div>
    </header>

    <main class="main">
        <div class="container">
            <div class="translator-container">
                <div class="language-selectors">
                    <select id="source-lang">
                        <option value="auto">Detect Language</option>
                        <optgroup label="Most Used">
                            <option value="en">English</option>
                            <option value="es">Spanish</option>
                            <option value="fr">French</option>
                            <option value="de">German</option>
                            <option value="zh">Chinese (Simplified)</option>
                            <option value="ja">Japanese</option>
                            <option value="ru">Russian</option>
                            <option value="ar">Arabic</option>
                            <option value="pt">Portuguese</option>
                            <option value="hi">Hindi</option>
                        </optgroup>
                        <optgroup label="European">
                            <option value="sq">Albanian</option>
                            <option value="hy">Armenian</option>
                            <option value="eu">Basque</option>
                            <option value="be">Belarusian</option>
                            <option value="bg">Bulgarian</option>
                            <option value="ca">Catalan</option>
                            <option value="hr">Croatian</option>
                            <option value="cs">Czech</option>
                            <option value="da">Danish</option>
                            <option value="nl">Dutch</option>
                            <option value="et">Estonian</option>
                            <option value="fi">Finnish</option>
                            <option value="gl">Galician</option>
                            <option value="el">Greek</option>
                            <option value="hu">Hungarian</option>
                            <option value="is">Icelandic</option>
                            <option value="ga">Irish</option>
                            <option value="it">Italian</option>
                            <option value="lv">Latvian</option>
                            <option value="lt">Lithuanian</option>
                            <option value="mk">Macedonian</option>
                            <option value="mt">Maltese</option>
                            <option value="no">Norwegian</option>
                            <option value="pl">Polish</option>
                            <option value="ro">Romanian</option>
                            <option value="sr">Serbian</option>
                            <option value="sk">Slovak</option>
                            <option value="sl">Slovenian</option>
                            <option value="sv">Swedish</option>
                            <option value="uk">Ukrainian</option>
                            <option value="cy">Welsh</option>
                        </optgroup>
                        <optgroup label="Asian">
                            <option value="bn">Bengali</option>
                            <option value="my">Burmese</option>
                            <option value="zh-TW">Chinese (Traditional)</option>
                            <option value="ka">Georgian</option>
                            <option value="gu">Gujarati</option>
                            <option value="he">Hebrew</option>
                            <option value="kn">Kannada</option>
                            <option value="km">Khmer</option>
                            <option value="ko">Korean</option>
                            <option value="lo">Lao</option>
                            <option value="ml">Malayalam</option>
                            <option value="mr">Marathi</option>
                            <option value="mn">Mongolian</option>
                            <option value="ne">Nepali</option>
                            <option value="pa">Punjabi</option>
                            <option value="sd">Sindhi</option>
                            <option value="si">Sinhala</option>
                            <option value="ta">Tamil</option>
                            <option value="te">Telugu</option>
                            <option value="th">Thai</option>
                            <option value="tr">Turkish</option>
                            <option value="ur">Urdu</option>
                            <option value="vi">Vietnamese</option>
                        </optgroup>
                        <optgroup label="African">
                            <option value="am">Amharic</option>
                            <option value="ha">Hausa</option>
                            <option value="rw">Kinyarwanda</option>
                            <option value="st">Sesotho</option>
                            <option value="so">Somali</option>
                            <option value="sw">Swahili</option>
                            <option value="xh">Xhosa</option>
                            <option value="yo">Yoruba</option>
                            <option value="zu">Zulu</option>
                        </optgroup>
                        <optgroup label="Other">
                            <option value="af">Afrikaans</option>
                            <option value="az">Azerbaijani</option>
                            <option value="bs">Bosnian</option>
                            <option value="ceb">Cebuano</option>
                            <option value="co">Corsican</option>
                            <option value="eo">Esperanto</option>
                            <option value="tl">Filipino</option>
                            <option value="fy">Frisian</option>
                            <option value="ht">Haitian Creole</option>
                            <option value="haw">Hawaiian</option>
                            <option value="hmn">Hmong</option>
                            <option value="ig">Igbo</option>
                            <option value="id">Indonesian</option>
                            <option value="jv">Javanese</option>
                            <option value="kk">Kazakh</option>
                            <option value="ku">Kurdish</option>
                            <option value="ky">Kyrgyz</option>
                            <option value="lb">Luxembourgish</option>
                            <option value="mg">Malagasy</option>
                            <option value="ms">Malay</option>
                            <option value="mi">Maori</option>
                            <option value="ny">Nyanja</option>
                            <option value="ps">Pashto</option>
                            <option value="fa">Persian</option>
                            <option value="sm">Samoan</option>
                            <option value="gd">Scots Gaelic</option>
                            <option value="sn">Shona</option>
                            <option value="su">Sundanese</option>
                            <option value="tg">Tajik</option>
                            <option value="tt">Tatar</option>
                            <option value="tk">Turkmen</option>
                            <option value="ug">Uyghur</option>
                            <option value="uz">Uzbek</option>
                            <option value="yi">Yiddish</option>
                        </optgroup>
                    </select>
                    
                    <button class="swap-btn" id="swap-languages">
                        <i class="fas fa-exchange-alt"></i>
                    </button>
                    
                    <select id="target-lang">
                        <optgroup label="Most Used">
                            <option value="en">English</option>
                            <option value="es">Spanish</option>
                            <option value="fr">French</option>
                            <option value="de">German</option>
                            <option value="zh">Chinese (Simplified)</option>
                            <option value="ja">Japanese</option>
                            <option value="ru">Russian</option>
                            <option value="ar">Arabic</option>
                            <option value="pt">Portuguese</option>
                            <option value="hi">Hindi</option>
                        </optgroup>
                        <optgroup label="European">
                            <option value="sq">Albanian</option>
                            <option value="hy">Armenian</option>
                            <option value="eu">Basque</option>
                            <option value="be">Belarusian</option>
                            <option value="bg">Bulgarian</option>
                            <option value="ca">Catalan</option>
                            <option value="hr">Croatian</option>
                            <option value="cs">Czech</option>
                            <option value="da">Danish</option>
                            <option value="nl">Dutch</option>
                            <option value="et">Estonian</option>
                            <option value="fi">Finnish</option>
                            <option value="gl">Galician</option>
                            <option value="el">Greek</option>
                            <option value="hu">Hungarian</option>
                            <option value="is">Icelandic</option>
                            <option value="ga">Irish</option>
                            <option value="it">Italian</option>
                            <option value="lv">Latvian</option>
                            <option value="lt">Lithuanian</option>
                            <option value="mk">Macedonian</option>
                            <option value="mt">Maltese</option>
                            <option value="no">Norwegian</option>
                            <option value="pl">Polish</option>
                            <option value="ro">Romanian</option>
                            <option value="sr">Serbian</option>
                            <option value="sk">Slovak</option>
                            <option value="sl">Slovenian</option>
                            <option value="sv">Swedish</option>
                            <option value="uk">Ukrainian</option>
                            <option value="cy">Welsh</option>
                        </optgroup>
                        <optgroup label="Asian">
                            <option value="bn">Bengali</option>
                            <option value="my">Burmese</option>
                            <option value="zh-TW">Chinese (Traditional)</option>
                            <option value="ka">Georgian</option>
                            <option value="gu">Gujarati</option>
                            <option value="he">Hebrew</option>
                            <option value="kn">Kannada</option>
                            <option value="km">Khmer</option>
                            <option value="ko">Korean</option>
                            <option value="lo">Lao</option>
                            <option value="ml">Malayalam</option>
                            <option value="mr">Marathi</option>
                            <option value="mn">Mongolian</option>
                            <option value="ne">Nepali</option>
                            <option value="pa">Punjabi</option>
                            <option value="sd">Sindhi</option>
                            <option value="si">Sinhala</option>
                            <option value="ta">Tamil</option>
                            <option value="te">Telugu</option>
                            <option value="th">Thai</option>
                            <option value="tr">Turkish</option>
                            <option value="ur">Urdu</option>
                            <option value="vi">Vietnamese</option>
                        </optgroup>
                        <optgroup label="African">
                            <option value="am">Amharic</option>
                            <option value="ha">Hausa</option>
                            <option value="rw">Kinyarwanda</option>
                            <option value="st">Sesotho</option>
                            <option value="so">Somali</option>
                            <option value="sw">Swahili</option>
                            <option value="xh">Xhosa</option>
                            <option value="yo">Yoruba</option>
                            <option value="zu">Zulu</option>
                        </optgroup>
                        <optgroup label="Other">
                            <option value="af">Afrikaans</option>
                            <option value="az">Azerbaijani</option>
                            <option value="bs">Bosnian</option>
                            <option value="ceb">Cebuano</option>
                            <option value="co">Corsican</option>
                            <option value="eo">Esperanto</option>
                            <option value="tl">Filipino</option>
                            <option value="fy">Frisian</option>
                            <option value="ht">Haitian Creole</option>
                            <option value="haw">Hawaiian</option>
                            <option value="hmn">Hmong</option>
                            <option value="ig">Igbo</option>
                            <option value="id">Indonesian</option>
                            <option value="jv">Javanese</option>
                            <option value="kk">Kazakh</option>
                            <option value="ku">Kurdish</option>
                            <option value="ky">Kyrgyz</option>
                            <option value="lb">Luxembourgish</option>
                            <option value="mg">Malagasy</option>
                            <option value="ms">Malay</option>
                            <option value="mi">Maori</option>
                            <option value="ny">Nyanja</option>
                            <option value="ps">Pashto</option>
                            <option value="fa">Persian</option>
                            <option value="sm">Samoan</option>
                            <option value="gd">Scots Gaelic</option>
                            <option value="sn">Shona</option>
                            <option value="su">Sundanese</option>
                            <option value="tg">Tajik</option>
                            <option value="tt">Tatar</option>
                            <option value="tk">Turkmen</option>
                            <option value="ug">Uyghur</option>
                            <option value="uz">Uzbek</option>
                            <option value="yi">Yiddish</option>
                        </optgroup>
                    </select>
                </div>
                
                <textarea id="input-text" placeholder="Enter text to translate..."></textarea>
                
                <!-- PDF Upload/Download Section -->
                <div class="file-upload-section">
                    <div class="file-upload-wrapper">
                        <label for="pdf-upload" class="file-upload-label">
                            <i class="fas fa-file-pdf"></i>
                            <span>Upload PDF</span>
                            <input type="file" id="pdf-upload" accept=".pdf" hidden>
                        </label>
                        <button class="download-btn" id="download-btn" disabled>
                            <i class="fas fa-file-download"></i>
                            <span>Download Translation</span>
                        </button>
                    </div>
                    <div class="file-info" id="file-info"></div>
                </div>
                
                <button class="translate-btn" id="translate-btn">
                    <i class="fas fa-language"></i>
                    <span>Translate</span>
                </button>
                
                <div class="translation-result" id="translation-result">
                    <div>Translation will appear here...</div>
                </div>
            </div>
        </div>
    </main>

    <div class="floating-actions">
        <button class="floating-btn" id="voice-btn" title="Voice Input">
            <i class="fas fa-microphone"></i>
        </button>
        <button class="floating-btn" id="copy-btn" title="Copy Text">
            <i class="far fa-copy"></i>
        </button>
        <button class="floating-btn" id="clear-btn" title="Clear Text">
            <i class="far fa-trash-alt"></i>
        </button>
    </div>

    <!-- AdMob Banner Ad -->
    <div class="ad-container">
        <div class="ad-banner"id="ad-banner">
            Advertisement
        </div>
    </div>

    <script>
        // Complete language mapping (150+ languages)
        const languageMap = {
            'af': 'Afrikaans',
            'sq': 'Albanian',
            'am': 'Amharic',
            'ar': 'Arabic',
            'hy': 'Armenian',
            'az': 'Azerbaijani',
            'eu': 'Basque',
            'be': 'Belarusian',
            'bn': 'Bengali',
            'bs': 'Bosnian',
            'bg': 'Bulgarian',
            'my': 'Burmese',
            'ca': 'Catalan',
            'ceb': 'Cebuano',
            'zh': 'Chinese (Simplified)',
            'zh-TW': 'Chinese (Traditional)',
            'co': 'Corsican',
            'hr': 'Croatian',
            'cs': 'Czech',
            'da': 'Danish',
            'nl': 'Dutch',
            'en': 'English',
            'eo': 'Esperanto',
            'et': 'Estonian',
            'fi': 'Finnish',
            'fr': 'French',
            'fy': 'Frisian',
            'gl': 'Galician',
            'ka': 'Georgian',
            'de': 'German',
            'el': 'Greek',
            'gu': 'Gujarati',
            'ht': 'Haitian Creole',
            'ha': 'Hausa',
            'haw': 'Hawaiian',
            'he': 'Hebrew',
            'hi': 'Hindi',
            'hmn': 'Hmong',
            'hu': 'Hungarian',
            'is': 'Icelandic',
            'ig': 'Igbo',
            'id': 'Indonesian',
            'ga': 'Irish',
            'it': 'Italian',
            'ja': 'Japanese',
            'jv': 'Javanese',
            'kn': 'Kannada',
            'kk': 'Kazakh',
            'km': 'Khmer',
            'rw': 'Kinyarwanda',
            'ko': 'Korean',
            'ku': 'Kurdish',
            'ky': 'Kyrgyz',
            'lo': 'Lao',
            'la': 'Latin',
            'lv': 'Latvian',
            'lt': 'Lithuanian',
            'lb': 'Luxembourgish',
            'mk': 'Macedonian',
            'mg': 'Malagasy',
            'ms': 'Malay',
            'ml': 'Malayalam',
            'mt': 'Maltese',
            'mi': 'Maori',
            'mr': 'Marathi',
            'mn': 'Mongolian',
            'ne': 'Nepali',
            'no': 'Norwegian',
            'ny': 'Nyanja',
            'or': 'Odia',
            'ps': 'Pashto',
            'fa': 'Persian',
            'pl': 'Polish',
            'pt': 'Portuguese',
            'pa': 'Punjabi',
            'ro': 'Romanian',
            'ru': 'Russian',
            'sm': 'Samoan',
            'gd': 'Scots Gaelic',
            'sr': 'Serbian',
            'st': 'Sesotho',
            'sn': 'Shona',
            'sd': 'Sindhi',
            'si': 'Sinhala',
            'sk': 'Slovak',
            'sl': 'Slovenian',
            'so': 'Somali',
            'es': 'Spanish',
            'su': 'Sundanese',
            'sw': 'Swahili',
            'sv': 'Swedish',
            'tl': 'Tagalog',
            'tg': 'Tajik',
            'ta': 'Tamil',
            'tt': 'Tatar',
            'te': 'Telugu',
            'th': 'Thai',
            'tr': 'Turkish',
            'tk': 'Turkmen',
            'uk': 'Ukrainian',
            'ur': 'Urdu',
            'ug': 'Uyghur',
            'uz': 'Uzbek',
            'vi': 'Vietnamese',
            'cy': 'Welsh',
            'xh': 'Xhosa',
            'yi': 'Yiddish',
            'yo': 'Yoruba',
            'zu': 'Zulu',
            'auto': 'Auto-detect'
        };

        // DOM Elements
        const translateBtn = document.getElementById('translate-btn');
        const inputText = document.getElementById('input-text');
        const translationResult = document.getElementById('translation-result');
        const sourceLang = document.getElementById('source-lang');
        const targetLang = document.getElementById('target-lang');
        const swapBtn = document.getElementById('swap-languages');
        const voiceBtn = document.getElementById('voice-btn');
        const copyBtn = document.getElementById('copy-btn');
        const clearBtn = document.getElementById('clear-btn');
        const pdfUpload = document.getElementById('pdf-upload');
        const downloadBtn = document.getElementById('download-btn');
        const fileInfo = document.getElementById('file-info');
        const adBanner = document.getElementById('ad-banner');

        // PDF handling variables
        let pdfFile = null;
        let translatedPdfContent = null;

        // MyMemory Translation API endpoint
        const API_URL = 'https://api.mymemory.translated.net/get';

        // Initialize PDF.js
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.worker.min.js';

        // Initialize AdMob
        function initAdMob() {
            // Replace with your AdMob publisher ID
            const publisherId = ca-app-pub-1294862199429236/2664850806
            
            // Create ad request
            const adRequest = {
                requestNonPersonalizedAdsOnly: true
            };
            
            // Create banner view
            const bannerView = new google.ads.AdManager({
                publisherId: publisherId,
                slotId: ca-app-pub-1294862199429236/2664850806
                adType: 'banner',
                position: 'BOTTOM_CENTER',
                size: 'SMART_BANNER'
            });
            
            // Display the ad
            bannerView.display(adBanner.id, adRequest);
            
            // Event listeners
            bannerView.addEventListener('onAdLoaded', () => {
                console.log('Ad loaded successfully');
            });
            
            bannerView.addEventListener('onAdFailedToLoad', (error) => {
                console.log('Ad failed to load:', error);
            });
            
            bannerView.addEventListener('onAdOpened', () => {
                console.log('Ad opened');
            });
            
            bannerView.addEventListener('onAdClosed', () => {
                console.log('Ad closed');
            });
            
            bannerView.addEventListener('onAdLeftApplication', () => {
                console.log('Ad left application');
            });
        }

        // Load AdMob when the page is fully loaded
        window.addEventListener('load', () => {
            initAdMob();
        });

        // Extract text from PDF
        async function extractTextFromPDF(file) {
            const arrayBuffer = await file.arrayBuffer();
            const loadingTask = pdfjsLib.getDocument(arrayBuffer);
            const pdf = await loadingTask.promise;
            
            let fullText = '';
            
            for (let i = 1; i <= pdf.numPages; i++) {
                const page = await pdf.getPage(i);
                const textContent = await page.getTextContent();
                const textItems = textContent.items.map(item => item.str);
                fullText += textItems.join(' ') + '\n\n';
            }
            
            return fullText;
        }

        // Generate translated PDF
        async function generateTranslatedPDF(text) {
            translatedPdfContent = text;
            downloadBtn.disabled = false;
        }

        // Real translation function using MyMemory API
        async function translateText(text, sourceLang, targetLang) {
            try {
                // If source language is auto, detect it first
                let actualSourceLang = sourceLang;
                if (sourceLang === 'auto') {
                    actualSourceLang = detectLanguage(text);
                }

                const response = await fetch(`${API_URL}?q=${encodeURIComponent(text)}&langpair=${actualSourceLang}|${targetLang}`);
                
                if (!response.ok) {
                    throw new Error(`API request failed with status ${response.status}`);
                }

                const data = await response.json();
                
                if (data.responseStatus !== 200 || !data.responseData) {
                    throw new Error(data.responseDetails || 'Translation failed');
                }

                return {
                    translatedText: data.responseData.translatedText,
                    detectedLanguage: actualSourceLang
                };
            } catch (error) {
                console.error('Translation error:', error);
                throw error;
            }
        }

        // Enhanced language detection for all languages
        function detectLanguage(text) {
            // Check for specific scripts first
            if (/[\u0600-\u06FF\u0750-\u077F\uFB50-\uFDFF\uFE70-\uFEFF]/.test(text)) {
                // Check for Urdu-specific words
                const urduWords = ['ہے', 'اور', 'کی', 'میں', 'ہیں'];
                if (urduWords.some(word => text.includes(word))) {
                    return 'ur';
                }
                return 'ar'; // Default to Arabic
            }
            if (/[а-яА-ЯЁё]/.test(text)) return 'ru';
            if (/[\u4e00-\u9fff]/.test(text)) return 'zh';
            if (/[\u3040-\u309f\u30a0-\u30ff]/.test(text)) return 'ja';
            if (/[가-힣]/.test(text)) return 'ko';
            if (/[α-ωΑ-Ω]/.test(text)) return 'el'; // Greek
            if (/[א-ת]/.test(text)) return 'he'; // Hebrew
            
            // Check for common words in various languages
            const languageChecks = {
                'en': ['the', 'be', 'to', 'of', 'and'],
                'es': ['el', 'la', 'de', 'que', 'y'],
                'fr': ['le', 'la', 'de', 'et', 'à'],
                'de': ['der', 'die', 'das', 'und', 'in'],
                'it': ['il', 'la', 'di', 'e', 'a'],
                'pt': ['o', 'a', 'de', 'e', 'que'],
                'hi': ['और', 'है', 'की', 'से', 'में'],
                'bn': ['এবং', 'হয়', 'এর', 'থেকে', 'মধ্যে'],
                'tr': ['ve', 'bir', 'bu', 'ben', 'sen'],
                'vi': ['và', 'là', 'của', 'tôi', 'bạn']
            };
            
            const textLower = text.toLowerCase();
            for (const [lang, words] of Object.entries(languageChecks)) {
                if (words.some(word => textLower.includes(word))) {
                    return lang;
                }
            }
            
            return 'en'; // Default to English
        }

        // Main translate function
        async function translate() {
            const text = inputText.value.trim();
            if (!text) return;
            
            translateBtn.disabled = true;
            translateBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Translating...';
            translationResult.innerHTML = '<div class="loading"><i class="fas fa-spinner fa-spin"></i> Translating...</div>';
            
            try {
                const sourceLangValue = sourceLang.value;
                const targetLangValue = targetLang.value;
                
                const { translatedText } = await translateText(text, sourceLangValue, targetLangValue);
                
                translationResult.innerHTML = translatedText;
                
                // If a PDF was uploaded, enable download
                if (pdfFile) {
                    await generateTranslatedPDF(translatedText);
                }
            } catch (error) {
                translationResult.innerHTML = `<div class="error">Error: ${error.message || 'Translation failed'}</div>`;
                console.error('Translation error:', error);
            }
            
            translateBtn.disabled = false;
            translateBtn.innerHTML = '<i class="fas fa-language"></i> <span>Translate</span>';
        }

        // Handle PDF upload
        pdfUpload.addEventListener('change', async (e) => {
            const file = e.target.files[0];
            if (!file) return;
            
            if (file.type !== 'application/pdf') {
                fileInfo.textContent = 'Please upload a PDF file';
                return;
            }
            
            pdfFile = file;
            fileInfo.textContent = `File: ${file.name} (${(file.size / 1024).toFixed(2)} KB)`;
            
            try {
                // Extract text from PDF
                const pdfText = await extractTextFromPDF(file);
                inputText.value = pdfText;
                
                // Auto-translate if there's enough text
                if (pdfText.length > 3) {
                    translate();
                }
            } catch (error) {
                fileInfo.textContent = 'Error reading PDF file';
                console.error('PDF extraction error:', error);
            }
        });

        // Download translated PDF
        downloadBtn.addEventListener('click', () => {
            if (!translatedPdfContent) return;
            
            // Create a new PDF with the translated text
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Split text into chunks that fit on a page
            const lines = doc.splitTextToSize(translatedPdfContent, 180);
            
            // Add text to PDF (10mm from left, 20mm from top)
            doc.text(lines, 10, 20);
            
            // Save the PDF
            doc.save('translated_document.pdf');
        });

        // Swap languages
        swapBtn.addEventListener('click', () => {
            const temp = sourceLang.value;
            sourceLang.value = targetLang.value;
            targetLang.value = temp;
            
            // If there's translated text, swap it with input
            if (translationResult.textContent && !translationResult.textContent.includes('Translation will appear') && 
                !translationResult.textContent.includes('Translating...') && 
                !translationResult.textContent.includes('Error')) {
                const tempText = inputText.value;
                inputText.value = translationResult.textContent;
                translationResult.innerHTML = tempText;
            }
        });

        // Voice input
        voiceBtn.addEventListener('click', () => {
            if ('webkitSpeechRecognition' in window) {
                const recognition = new webkitSpeechRecognition();
                
                // Set language based on source selection
                let langCode = sourceLang.value === 'auto' ? 'en-US' : sourceLang.value;
                
                // Special cases for language codes
                if (langCode === 'zh') langCode = 'zh-CN';
                if (langCode === 'zh-TW') langCode = 'zh-TW';
                if (langCode === 'he') langCode = 'he-IL';
                if (langCode === 'ur') langCode = 'ur-PK';
                
                recognition.lang = langCode;
                recognition.interimResults = false;
                
                recognition.onstart = () => {
                    voiceBtn.innerHTML = '<i class="fas fa-microphone-slash"></i>';
                    voiceBtn.style.backgroundColor = '#ef4444';
                };
                
                recognition.onresult = (event) => {
                    const transcript = event.results[0][0].transcript;
                    inputText.value = transcript;
                    voiceBtn.innerHTML = '<i class="fas fa-microphone"></i>';
                    voiceBtn.style.backgroundColor = '';
                    translate(); // Auto-translate after voice input
                };
                
                recognition.onerror = () => {
                    voiceBtn.innerHTML = '<i class="fas fa-microphone"></i>';
                    voiceBtn.style.backgroundColor = '';
                };
                
                recognition.start();
            } else {
                alert('Speech recognition not supported in your browser');
            }
        });

        // Copy text
        copyBtn.addEventListener('click', () => {
            if (translationResult.textContent && !translationResult.textContent.includes('Translation will appear')) {
                navigator.clipboard.writeText(translationResult.textContent)
                    .then(() => {
                        const originalText = copyBtn.innerHTML;
                        copyBtn.innerHTML = '<i class="fas fa-check"></i>';
                        setTimeout(() => {
                            copyBtn.innerHTML = originalText;
                        }, 2000);
                    })
                    .catch(err => {
                        console.error('Failed to copy text: ', err);
                    });
            }
        });

        // Clear text
        clearBtn.addEventListener('click', () => {
            inputText.value = '';
            translationResult.innerHTML = '<div>Translation will appear here...</div>';
            pdfFile = null;
            translatedPdfContent = null;
            fileInfo.textContent = '';
            downloadBtn.disabled = true;
            pdfUpload.value = '';
        });

        // Initialize
        translateBtn.addEventListener('click', translate);

        // Auto-translate when typing (with debounce)
        let debounceTimer;
        inputText.addEventListener('input', () => {
            clearTimeout(debounceTimer);
            debounceTimer = setTimeout(() => {
                if (inputText.value.trim().length > 3) { // Only translate if at least 3 characters
                    translate();
                }
            }, 1000);
        });
    </script>
</body>
</html>
