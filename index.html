<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LingoAI - Real Translation App</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #3b82f6;
            --primary-dark: #2563eb;
            --light: #ffffff;
            --dark: #1f2937;
            --gray: #6b7280;
            --light-gray: #f3f4f6;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--light);
            color: var(--dark);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        header {
            padding: 15px 0;
            position: sticky;
            top: 0;
            background-color: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            z-index: 100;
            box-shadow: var(--shadow);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .main {
            padding: 40px 0;
        }

        .translator-container {
            background-color: var(--light);
            border-radius: 12px;
            padding: 30px;
            box-shadow: var(--shadow);
            max-width: 800px;
            margin: 0 auto;
        }

        .language-selectors {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        select {
            flex: 1;
            padding: 12px 15px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            font-size: 16px;
            background-color: var(--light);
            cursor: pointer;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 16px;
        }

        .swap-btn {
            background-color: var(--light-gray);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: none;
            transition: all 0.3s ease;
        }

        .swap-btn:hover {
            background-color: var(--primary);
            color: white;
        }

        textarea {
            width: 100%;
            min-height: 150px;
            padding: 15px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            font-size: 16px;
            resize: vertical;
            margin-bottom: 20px;
        }

        .translate-btn {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 16px;
            font-weight: 600;
            border-radius: 8px;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .translate-btn:hover {
            background-color: var(--primary-dark);
        }

        .translate-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }

        .translation-result {
            background-color: var(--light-gray);
            border-radius: 8px;
            padding: 20px;
            min-height: 150px;
            margin-top: 20px;
        }

        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            color: var(--gray);
        }

        .error {
            color: #ef4444;
        }

        .floating-actions {
            position: fixed;
            bottom: 30px;
            right: 30px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .floating-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
        }

        .floating-btn:hover {
            transform: translateY(-3px);
            background: var(--primary-dark);
        }

        .history-panel {
            position: fixed;
            top: 80px;
            right: 20px;
            width: 300px;
            background: var(--light);
            border-radius: 10px;
            box-shadow: var(--shadow);
            padding: 15px;
            z-index: 99;
            max-height: calc(100vh - 120px);
            overflow-y: auto;
        }

        .history-item {
            padding: 10px;
            border-bottom: 1px solid var(--light-gray);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .history-item:hover {
            background-color: var(--light-gray);
        }

        @media (max-width: 768px) {
            .language-selectors {
                flex-direction: column;
            }
            
            .swap-btn {
                transform: rotate(90deg);
                margin: 10px 0;
            }
            
            .history-panel {
                position: static;
                width: 100%;
                margin-top: 30px;
                max-height: 200px;
            }
            
            .floating-actions {
                bottom: 20px;
                right: 20px;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container header-content">
            <a href="#" class="logo">
                <i class="fas fa-language"></i>
                <span>LingoAI</span>
            </a>
        </div>
    </header>

    <main class="main">
        <div class="container">
            <div class="translator-container">
                <div class="language-selectors">
                    <select id="source-lang">
                        <option value="auto">Detect Language</option>
                        <option value="en">English</option>
                        <option value="es">Spanish</option>
                        <option value="fr">French</option>
                        <option value="de">German</option>
                        <option value="it">Italian</option>
                        <option value="pt">Portuguese</option>
                        <option value="ru">Russian</option>
                        <option value="zh">Chinese</option>
                        <option value="ja">Japanese</option>
                        <option value="ar">Arabic</option>
                    </select>
                    
                    <button class="swap-btn" id="swap-languages">
                        <i class="fas fa-exchange-alt"></i>
                    </button>
                    
                    <select id="target-lang">
                        <option value="es">Spanish</option>
                        <option value="en">English</option>
                        <option value="fr">French</option>
                        <option value="de">German</option>
                        <option value="it">Italian</option>
                        <option value="pt">Portuguese</option>
                        <option value="ru">Russian</option>
                        <option value="zh">Chinese</option>
                        <option value="ja">Japanese</option>
                        <option value="ar">Arabic</option>
                    </select>
                </div>
                
                <textarea id="input-text" placeholder="Enter text to translate..."></textarea>
                
                <button class="translate-btn" id="translate-btn">
                    <i class="fas fa-language"></i>
                    <span>Translate</span>
                </button>
                
                <div class="translation-result" id="translation-result">
                    <div>Translation will appear here...</div>
                </div>
            </div>
        </div>
    </main>

    <div class="floating-actions">
        <button class="floating-btn" id="voice-btn" title="Voice Input">
            <i class="fas fa-microphone"></i>
        </button>
        <button class="floating-btn" id="copy-btn" title="Copy Text">
            <i class="far fa-copy"></i>
        </button>
        <button class="floating-btn" id="clear-btn" title="Clear Text">
            <i class="far fa-trash-alt"></i>
        </button>
    </div>

    <div class="history-panel">
        <h3>Translation History</h3>
        <div id="history-items"></div>
    </div>

    <script>
        // Language mapping
        const languageMap = {
            'auto': 'Auto-detect',
            'en': 'English',
            'es': 'Spanish',
            'fr': 'French',
            'de': 'German',
            'it': 'Italian',
            'pt': 'Portuguese',
            'ru': 'Russian',
            'zh': 'Chinese',
            'ja': 'Japanese',
            'ar': 'Arabic'
        };

        // DOM Elements
        const translateBtn = document.getElementById('translate-btn');
        const inputText = document.getElementById('input-text');
        const translationResult = document.getElementById('translation-result');
        const sourceLang = document.getElementById('source-lang');
        const targetLang = document.getElementById('target-lang');
        const swapBtn = document.getElementById('swap-languages');
        const voiceBtn = document.getElementById('voice-btn');
        const copyBtn = document.getElementById('copy-btn');
        const clearBtn = document.getElementById('clear-btn');
        const historyItems = document.getElementById('history-items');

        // MyMemory Translation API endpoint
        const API_URL = 'https://api.mymemory.translated.net/get';

        // Real translation function using MyMemory API
        async function translateText(text, sourceLang, targetLang) {
            try {
                // If source language is auto, detect it first
                let actualSourceLang = sourceLang;
                if (sourceLang === 'auto') {
                    actualSourceLang = detectLanguage(text);
                }

                const response = await fetch(`${API_URL}?q=${encodeURIComponent(text)}&langpair=${actualSourceLang}|${targetLang}`);
                
                if (!response.ok) {
                    throw new Error(`API request failed with status ${response.status}`);
                }

                const data = await response.json();
                
                if (data.responseStatus !== 200 || !data.responseData) {
                    throw new Error(data.responseDetails || 'Translation failed');
                }

                return {
                    translatedText: data.responseData.translatedText,
                    detectedLanguage: actualSourceLang
                };
            } catch (error) {
                console.error('Translation error:', error);
                throw error;
            }
        }

        // Language detection (simplified)
        function detectLanguage(text) {
            if (/[а-яА-ЯЁё]/.test(text)) return 'ru';
            if (/[\u4e00-\u9fff]/.test(text)) return 'zh';
            if (/[\u3040-\u309f\u30a0-\u30ff]/.test(text)) return 'ja';
            if (/[가-힣]/.test(text)) return 'ko';
            if (/[ء-ي]/.test(text)) return 'ar';
            
            // Check for common words in European languages
            const commonWords = {
                'en': ['the', 'be', 'to', 'of', 'and'],
                'es': ['el', 'la', 'de', 'que', 'y'],
                'fr': ['le', 'la', 'de', 'et', 'à'],
                'de': ['der', 'die', 'das', 'und', 'in'],
                'it': ['il', 'la', 'di', 'e', 'a']
            };
            
            const textLower = text.toLowerCase();
            for (const [lang, words] of Object.entries(commonWords)) {
                if (words.some(word => textLower.includes(word))) {
                    return lang;
                }
            }
            
            return 'en'; // Default to English
        }

        // Main translate function
        async function translate() {
            const text = inputText.value.trim();
            if (!text) return;
            
            translateBtn.disabled = true;
            translateBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Translating...';
            translationResult.innerHTML = '<div class="loading"><i class="fas fa-spinner fa-spin"></i> Translating...</div>';
            
            try {
                const sourceLangValue = sourceLang.value;
                const targetLangValue = targetLang.value;
                
                const { translatedText, detectedLanguage } = await translateText(text, sourceLangValue, targetLangValue);
                
                translationResult.innerHTML = translatedText;
                saveToHistory(text, translatedText, detectedLanguage, targetLangValue);
            } catch (error) {
                translationResult.innerHTML = `<div class="error">Error: ${error.message || 'Translation failed'}</div>`;
                console.error('Translation error:', error);
            }
            
            translateBtn.disabled = false;
            translateBtn.innerHTML = '<i class="fas fa-language"></i> <span>Translate</span>';
        }

        // Swap languages
        swapBtn.addEventListener('click', () => {
            const temp = sourceLang.value;
            sourceLang.value = targetLang.value;
            targetLang.value = temp;
            
            // If there's translated text, swap it with input
            if (translationResult.textContent && !translationResult.textContent.includes('Translation will appear') && 
                !translationResult.textContent.includes('Translating...') && 
                !translationResult.textContent.includes('Error')) {
                const tempText = inputText.value;
                inputText.value = translationResult.textContent;
                translationResult.innerHTML = tempText;
            }
        });

        // Voice input
        voiceBtn.addEventListener('click', () => {
            if ('webkitSpeechRecognition' in window) {
                const recognition = new webkitSpeechRecognition();
                recognition.lang = sourceLang.value === 'auto' ? 'en-US' : `${sourceLang.value}-${sourceLang.value.toUpperCase()}`;
                recognition.interimResults = false;
                
                recognition.onstart = () => {
                    voiceBtn.innerHTML = '<i class="fas fa-microphone-slash"></i>';
                    voiceBtn.style.backgroundColor = '#ef4444';
                };
                
                recognition.onresult = (event) => {
                    const transcript = event.results[0][0].transcript;
                    inputText.value = transcript;
                    voiceBtn.innerHTML = '<i class="fas fa-microphone"></i>';
                    voiceBtn.style.backgroundColor = '';
                    translate(); // Auto-translate after voice input
                };
                
                recognition.onerror = () => {
                    voiceBtn.innerHTML = '<i class="fas fa-microphone"></i>';
                    voiceBtn.style.backgroundColor = '';
                };
                
                recognition.start();
            } else {
                alert('Speech recognition not supported in your browser');
            }
        });

        // Copy text
        copyBtn.addEventListener('click', () => {
            if (translationResult.textContent && !translationResult.textContent.includes('Translation will appear')) {
                navigator.clipboard.writeText(translationResult.textContent)
                    .then(() => {
                        const originalText = copyBtn.innerHTML;
                        copyBtn.innerHTML = '<i class="fas fa-check"></i>';
                        setTimeout(() => {
                            copyBtn.innerHTML = originalText;
                        }, 2000);
                    })
                    .catch(err => {
                        console.error('Failed to copy text: ', err);
                    });
            }
        });

        // Clear text
        clearBtn.addEventListener('click', () => {
            inputText.value = '';
            translationResult.innerHTML = '<div>Translation will appear here...</div>';
        });

        // Save to history
        function saveToHistory(sourceText, translatedText, sourceLang, targetLang) {
            let history = JSON.parse(localStorage.getItem('translationHistory')) || [];
            
            history.unshift({
                sourceText,
                translatedText,
                sourceLang,
                targetLang,
                timestamp: new Date().toISOString()
            });
            
            // Keep only last 10 items
            if (history.length > 10) {
                history = history.slice(0, 10);
            }
            
            localStorage.setItem('translationHistory', JSON.stringify(history));
            renderHistory();
        }

        // Render history
        function renderHistory() {
            const history = JSON.parse(localStorage.getItem('translationHistory')) || [];
            historyItems.innerHTML = '';
            
            if (history.length === 0) {
                historyItems.innerHTML = '<div style="color: var(--gray); text-align: center; padding: 10px;">No translation history yet</div>';
                return;
            }
            
            history.forEach(item => {
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                historyItem.innerHTML = `
                    <div><strong>${languageMap[item.sourceLang] || item.sourceLang} → ${languageMap[item.targetLang] || item.targetLang}</strong></div>
                    <div style="margin-top: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${item.sourceText}</div>
                    <div style="font-size: 12px; color: var(--gray); margin-top: 5px;">${new Date(item.timestamp).toLocaleString()}</div>
                `;
                
                historyItem.addEventListener('click', () => {
                    inputText.value = item.sourceText;
                    sourceLang.value = item.sourceLang;
                    targetLang.value = item.targetLang;
                    translationResult.innerHTML = item.translatedText;
                });
                
                historyItems.appendChild(historyItem);
            });
        }

        // Initialize
        translateBtn.addEventListener('click', translate);
        renderHistory();

        // Auto-translate when typing (with debounce)
        let debounceTimer;
        inputText.addEventListener('input', () => {
            clearTimeout(debounceTimer);
            debounceTimer = setTimeout(() => {
                if (inputText.value.trim().length > 3) { // Only translate if at least 3 characters
                    translate();
                }
            }, 1000);
        });
    </script>
</body>
</html>
